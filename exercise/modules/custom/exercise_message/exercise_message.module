<?php
/**
 * @file
 * Code for the Exercise message feature.
 */

include_once 'exercise_message.features.inc';

/**
 * Implements hook_comment_insert().
 */
function exercise_message_comment_insert($comment) {
  // Load the node
  $node = node_load($comment->nid);

  // Create a new message
  $message = message_create('new_comment', array('uid' => $comment->uid));

  // Save reference to the node in the node reference field, and the
  // "publish" state (i.e. if the node is published or unpublished).
  $wrapper = entity_metadata_wrapper('message', $message);
  $wrapper->field_node->set($node);
  $wrapper->field_comment->set($comment);

  $wrapper->save();
}
